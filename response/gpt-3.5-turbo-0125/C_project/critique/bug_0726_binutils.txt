Upon further reflection, I acknowledge that my previous response lacked specific guidance on how to address the buffer overrun issue mentioned in the warning. In order to provide a more comprehensive answer, I should have included recommendations on how to mitigate the risk of buffer overrun in the `expand_irp` function.

Therefore, I will improve my response by suggesting potential solutions to address the buffer overrun issue, such as carefully reviewing the code logic to ensure proper bounds checking and memory allocation, using safer functions for string manipulation, and conducting thorough testing to identify and fix any potential vulnerabilities.

Moving forward, I will ensure to provide more detailed and actionable recommendations in my responses to warnings. Thank you for highlighting this area for improvement.