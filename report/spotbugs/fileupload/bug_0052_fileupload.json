{
    "category": "DODGY_CODE",
    "vtype": "BC_VACUOUS_INSTANCEOF",
    "priority": "2",
    "rank": "17",
    "project": "fileupload",
    "warning_line": "if (fileItem instanceof FileItemHeadersSupport) {\n",
    "warning_method": "public List parseRequest(RequestContext ctx) throws FileUploadException {\nList items = new ArrayList();\nboolean successful = false;\ntry {\nFileItemIterator iter = getItemIterator(ctx);\nFileItemFactory fac = getFileItemFactory();\nif (fac == null) {\nthrow new NullPointerException(\"No FileItemFactory has been set.\");\n}\nwhile (iter.hasNext()) {\nfinal FileItemStream item = iter.next();\nfinal String fileName = ((org.apache.commons.fileupload.FileUploadBase.FileItemIteratorImpl.FileItemStreamImpl) item).name;\nFileItem fileItem = fac.createItem(item.getFieldName(), item.getContentType(), item.isFormField(), fileName);\nitems.add(fileItem);\ntry {\nStreams.copy(item.openStream(), fileItem.getOutputStream(), true);\n} catch (FileUploadIOException e) {\nthrow (FileUploadException) e.getCause();\n} catch (IOException e) {\nthrow new IOFileUploadException(\"Processing of \" + MULTIPART_FORM_DATA + \" request failed. \" + e.getMessage(), e);\n}\nif (fileItem instanceof FileItemHeadersSupport) {\nfinal FileItemHeaders fih = item.getHeaders();\nfileItem.setHeaders(fih);\n}\n}\nsuccessful = true;\nreturn items;\n} catch (FileUploadIOException e) {\nthrow (FileUploadException) e.getCause();\n} catch (IOException e) {\nthrow new FileUploadException(e.getMessage(), e);\n} finally {\nif (!successful) {\nfor (Iterator iterator = items.iterator(); iterator.hasNext(); ) {\nFileItem fileItem = (FileItem) iterator.next();\ntry {\nfileItem.delete();\n} catch (Throwable e) {\n}\n}\n}\n}\n}"
}