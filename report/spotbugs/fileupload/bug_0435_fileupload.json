{
    "category": "DODGY_CODE",
    "vtype": "BC_UNCONFIRMED_CAST_OF_RETURN_VALUE",
    "priority": "3",
    "rank": "20",
    "project": "fileupload",
    "warning_line": "throw (FileUploadException) e.getCause();\n",
    "warning_method": "public List<FileItem> parseRequest(RequestContext ctx) throws FileUploadException {\nList<FileItem> items = new ArrayList<FileItem>();\nboolean successful = false;\ntry {\nFileItemIterator iter = getItemIterator(ctx);\nFileItemFactory fileItemFactory = Objects.requireNonNull(getFileItemFactory(), \"No FileItemFactory has been set.\");\nfinal byte[] buffer = new byte[Streams.DEFAULT_BUFFER_SIZE];\nwhile (iter.hasNext()) {\nfinal FileItemStream item = iter.next();\nfinal String fileName = ((FileItemStreamImpl) item).getName();\nFileItem fileItem = fileItemFactory.createItem(item.getFieldName(), item.getContentType(), item.isFormField(), fileName);\nitems.add(fileItem);\ntry {\nStreams.copy(item.openStream(), fileItem.getOutputStream(), true, buffer);\n} catch (FileUploadIOException e) {\nthrow (FileUploadException) e.getCause();\n} catch (IOException e) {\nthrow new IOFileUploadException(format(\"Processing of %s request failed. %s\", MULTIPART_FORM_DATA, e.getMessage()), e);\n}\nfinal FileItemHeaders fih = item.getHeaders();\nfileItem.setHeaders(fih);\n}\nsuccessful = true;\nreturn items;\n} catch (FileUploadException e) {\nthrow e;\n} catch (IOException e) {\nthrow new FileUploadException(e.getMessage(), e);\n} finally {\nif (!successful) {\nfor (FileItem fileItem : items) {\ntry {\nfileItem.delete();\n} catch (Exception ignored) {\n}\n}\n}\n}\n}"
}