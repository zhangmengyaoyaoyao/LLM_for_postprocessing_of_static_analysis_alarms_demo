{
    "category": "I18N",
    "vtype": "DM_DEFAULT_ENCODING",
    "priority": "1",
    "rank": "19",
    "project": "net",
    "warning_line": "Base64.encodeBase64((\"\\000\" + username + \"\\000\" + password).getBytes())\n",
    "warning_method": "public boolean auth(AuthenticatingIMAPClient.AUTH_METHOD method, String username, String password) throws IOException, NoSuchAlgorithmException, InvalidKeyException, InvalidKeySpecException {\nif (!IMAPReply.isContinuation(sendCommand(IMAPCommand.AUTHENTICATE, method.getAuthName()))) {\nreturn false;\n}\nswitch(method) {\ncase PLAIN:\n{\nint result = sendData(new String(Base64.encodeBase64((\"\\000\" + username + \"\\000\" + password).getBytes())));\nif (result == IMAPReply.OK) {\nsetState(IMAP.IMAPState.AUTH_STATE);\n}\nreturn result == IMAPReply.OK;\n}\ncase CRAM_MD5:\n{\nbyte[] serverChallenge = Base64.decodeBase64(getReplyString().substring(2).trim());\nMac hmac_md5 = Mac.getInstance(\"HmacMD5\");\nhmac_md5.init(new SecretKeySpec(password.getBytes(), \"HmacMD5\"));\n// compute the result:\nbyte[] hmacResult = _convertToHexString(hmac_md5.doFinal(serverChallenge)).getBytes();\nbyte[] usernameBytes = username.getBytes();\nbyte[] toEncode = new byte[usernameBytes.length + 1 + hmacResult.length];\nSystem.arraycopy(usernameBytes, 0, toEncode, 0, usernameBytes.length);\ntoEncode[usernameBytes.length] = ' ';\nSystem.arraycopy(hmacResult, 0, toEncode, usernameBytes.length + 1, hmacResult.length);\n// send the reply and read the server code:\nint result = sendData(new String(Base64.encodeBase64(toEncode)));\nif (result == IMAPReply.OK) {\nsetState(IMAP.IMAPState.AUTH_STATE);\n}\nreturn result == IMAPReply.OK;\n}\ncase LOGIN:\n{\nif (sendData(new String(Base64.encodeBase64(username.getBytes()))) != IMAPReply.CONT) {\nreturn false;\n}\nint result = sendData(new String(Base64.encodeBase64(password.getBytes())));\nif (result == IMAPReply.OK) {\nsetState(IMAP.IMAPState.AUTH_STATE);\n}\nreturn result == IMAPReply.OK;\n}\n}\nreturn false;\n}"
}