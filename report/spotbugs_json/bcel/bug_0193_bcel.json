{
    "category": "DODGY_CODE",
    "vtype": "BC_UNCONFIRMED_CAST",
    "priority": "3",
    "rank": "20",
    "project": "bcel",
    "warning_line": "return addUtf8(((ConstantUtf8) c).getBytes());\n",
    "warning_method": "public int addConstant(Constant c, ConstantPoolGen cp) {\nConstant[] constants = cp.getConstantPool().getConstantPool();\nswitch(c.getTag()) {\ncase Const.CONSTANT_String:\n{\nConstantString s = (ConstantString) c;\nConstantUtf8 u8 = (ConstantUtf8) constants[s.getStringIndex()];\nreturn addString(u8.getBytes());\n}\ncase Const.CONSTANT_Class:\n{\nConstantClass s = (ConstantClass) c;\nConstantUtf8 u8 = (ConstantUtf8) constants[s.getNameIndex()];\nreturn addClass(u8.getBytes());\n}\ncase Const.CONSTANT_NameAndType:\n{\nConstantNameAndType n = (ConstantNameAndType) c;\nConstantUtf8 u8 = (ConstantUtf8) constants[n.getNameIndex()];\nConstantUtf8 u8_2 = (ConstantUtf8) constants[n.getSignatureIndex()];\nreturn addNameAndType(u8.getBytes(), u8_2.getBytes());\n}\ncase Const.CONSTANT_Utf8:\nreturn addUtf8(((ConstantUtf8) c).getBytes());\ncase Const.CONSTANT_Double:\nreturn addDouble(((ConstantDouble) c).getBytes());\ncase Const.CONSTANT_Float:\nreturn addFloat(((ConstantFloat) c).getBytes());\ncase Const.CONSTANT_Long:\nreturn addLong(((ConstantLong) c).getBytes());\ncase Const.CONSTANT_Integer:\nreturn addInteger(((ConstantInteger) c).getBytes());\ncase Const.CONSTANT_InterfaceMethodref:\ncase Const.CONSTANT_Methodref:\ncase Const.CONSTANT_Fieldref:\n{\nConstantCP m = (ConstantCP) c;\nConstantClass clazz = (ConstantClass) constants[m.getClassIndex()];\nConstantNameAndType n = (ConstantNameAndType) constants[m.getNameAndTypeIndex()];\nConstantUtf8 u8 = (ConstantUtf8) constants[clazz.getNameIndex()];\nString class_name = u8.getBytes().replace('/', '.');\nu8 = (ConstantUtf8) constants[n.getNameIndex()];\nString name = u8.getBytes();\nu8 = (ConstantUtf8) constants[n.getSignatureIndex()];\nString signature = u8.getBytes();\nswitch(c.getTag()) {\ncase Const.CONSTANT_InterfaceMethodref:\nreturn addInterfaceMethodref(class_name, name, signature);\ncase Const.CONSTANT_Methodref:\nreturn addMethodref(class_name, name, signature);\ncase Const.CONSTANT_Fieldref:\nreturn addFieldref(class_name, name, signature);\ndefault:\n// Never reached\nthrow new RuntimeException(\"Unknown constant type \" + c);\n}\n}\ndefault:\n// Never reached\nthrow new RuntimeException(\"Unknown constant type \" + c);\n}\n}"
}