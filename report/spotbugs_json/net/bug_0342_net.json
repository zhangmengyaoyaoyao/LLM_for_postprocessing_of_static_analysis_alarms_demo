{
    "category": "I18N",
    "vtype": "DM_DEFAULT_ENCODING",
    "priority": "1",
    "rank": "19",
    "project": "net",
    "warning_line": "Base64.encodeBase64((\"\\000\" + username + \"\\000\" + password).getBytes())\n",
    "warning_method": "public boolean auth(AuthenticatingSMTPClient.AUTH_METHOD method, String username, String password) throws IOException, NoSuchAlgorithmException, InvalidKeyException, InvalidKeySpecException {\nif (!SMTPReply.isPositiveIntermediate(sendCommand(SMTPCommand.AUTH, AUTH_METHOD.getAuthName(method)))) {\nreturn false;\n}\nif (method.equals(AUTH_METHOD.PLAIN)) {\nreturn SMTPReply.isPositiveCompletion(sendCommand(new String(Base64.encodeBase64((\"\\000\" + username + \"\\000\" + password).getBytes()))));\n} else if (method.equals(AUTH_METHOD.CRAM_MD5)) {\nbyte[] serverChallenge = Base64.decodeBase64(getReplyString().substring(4).trim());\nMac hmac_md5 = Mac.getInstance(\"HmacMD5\");\nhmac_md5.init(new SecretKeySpec(password.getBytes(), \"HmacMD5\"));\n// compute the result:\nbyte[] hmacResult = _convertToHexString(hmac_md5.doFinal(serverChallenge)).getBytes();\nbyte[] usernameBytes = username.getBytes();\nbyte[] toEncode = new byte[usernameBytes.length + 1 + hmacResult.length];\nSystem.arraycopy(usernameBytes, 0, toEncode, 0, usernameBytes.length);\ntoEncode[usernameBytes.length] = ' ';\nSystem.arraycopy(hmacResult, 0, toEncode, usernameBytes.length + 1, hmacResult.length);\n// send the reply and read the server code:\nreturn SMTPReply.isPositiveCompletion(sendCommand(new String(Base64.encodeBase64(toEncode))));\n} else if (method.equals(AUTH_METHOD.LOGIN)) {\nif (!SMTPReply.isPositiveIntermediate(sendCommand(new String(Base64.encodeBase64(username.getBytes()))))) {\nreturn false;\n}\nreturn SMTPReply.isPositiveCompletion(sendCommand(new String(Base64.encodeBase64(password.getBytes()))));\n} else {\nreturn false;\n}\n}"
}