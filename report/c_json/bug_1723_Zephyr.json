{
    "project": "Zephyr",
    "tool": "Infer",
    "category": "Null Dereference",
    "file": "subsys/bluetooth/host/hci_core.c",
    "message": "pointer `null` is dereferenced by call to `bt_hci_cmd_send_sync()` at line 4119, column 9.",
    "warning_function_name": "common_init",
    "warning_line": "err = bt_hci_cmd_send_sync(BT_HCI_OP_RESET, NULL, &rsp);",
    "warning_context": "static int common_init(void)\n{\n\tstruct net_buf *rsp;\n\tint err;\n\n\tif (!(bt_dev.drv->quirks & BT_QUIRK_NO_RESET)) {\n\t\t/* Send HCI_RESET */\n\t\terr = bt_hci_cmd_send_sync(BT_HCI_OP_RESET, NULL, &rsp);\n\t\tif (err) {\n\t\t\treturn err;\n\t\t}\n\t\thci_reset_complete(rsp);\n\t\tnet_buf_unref(rsp);\n\t}\n\n\t/* Read Local Supported Features */\n\terr = bt_hci_cmd_send_sync(BT_HCI_OP_READ_LOCAL_FEATURES, NULL, &rsp);\n\tif (err) {\n\t\treturn err;\n\t}\n\tread_local_features_complete(rsp);\n\tnet_buf_unref(rsp);\n\n\t/* Read Local Version Information */\n\terr = bt_hci_cmd_send_sync(BT_HCI_OP_READ_LOCAL_VERSION_INFO, NULL,\n\t\t\t\t   &rsp);\n\tif (err) {\n\t\treturn err;\n\t}\n\tread_local_ver_complete(rsp);\n\tnet_buf_unref(rsp);\n\n\t/* Read Bluetooth Address */\n\tif (!atomic_test_bit(bt_dev.flags, BT_DEV_USER_ID_ADDR)) {\n\t\terr = bt_hci_cmd_send_sync(BT_HCI_OP_READ_BD_ADDR, NULL, &rsp);\n\t\tif (err) {\n\t\t\treturn err;\n\t\t}\n\t\tread_bdaddr_complete(rsp);\n\t\tnet_buf_unref(rsp);\n\t}\n\n\t/* Read Local Supported Commands */\n\terr = bt_hci_cmd_send_sync(BT_HCI_OP_READ_SUPPORTED_COMMANDS, NULL,\n\t\t\t\t   &rsp);\n\tif (err) {\n\t\treturn err;\n\t}\n\tread_supported_commands_complete(rsp);\n\tnet_buf_unref(rsp);\n\n\tif (IS_ENABLED(CONFIG_BT_HOST_CRYPTO)) {\n\t\t/* Initialize the PRNG so that it is safe to use it later\n\t\t * on in the initialization process.\n\t\t */\n\t\terr = prng_init();\n\t\tif (err) {\n\t\t\treturn err;\n\t\t}\n\t}\n\n#if defined(CONFIG_BT_HCI_ACL_FLOW_CONTROL)\n\terr = set_flow_control();\n\tif (err) {\n\t\treturn err;\n\t}\n#endif /* CONFIG_BT_HCI_ACL_FLOW_CONTROL */\n\n\treturn 0;\n}\n"
}