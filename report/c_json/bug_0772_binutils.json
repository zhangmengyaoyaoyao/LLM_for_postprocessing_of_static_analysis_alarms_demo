{
    "Project": "binutils",
    "Tool": "Infer",
    "category": "BUFFER_OVERRUN_L3",
    "file": "bfd/elflink.c",
    "message": "Offset added: [-20, 267] (⇐ [-132, 155] + 112) Size: 4064 by call to `bfd_zalloc`.",
    "warning_function_name": "_bfd_elf_link_assign_sym_version",
    "warning_line": "t = (struct bfd_elf_version_tree *) bfd_zalloc (info->output_bfd, amt);",
    "warning_context": "      struct bfd_elf_version_tree *t;\n      bfd_boolean hidden;\n\n      hidden = TRUE;\n\n      /* There are two consecutive ELF_VER_CHR characters if this is\n\t not a hidden symbol.  */\n      ++p;\n      if (*p == ELF_VER_CHR)\n\t{\n\t  hidden = FALSE;\n\t  ++p;\n\t}\n\n      /* If there is no version string, we can just return out.  */\n      if (*p == '\\0')\n\t{\n\t  if (hidden)\n\t    h->hidden = 1;\n\t  return TRUE;\n\t}\n\n      /* Look for the version.  If we find it, it is no longer weak.  */\n      for (t = sinfo->info->version_info; t != NULL; t = t->next)\n\t{\n\t  if (strcmp (t->name, p) == 0)\n\t    {\n\t      size_t len;\n\t      char *alc;\n\t      struct bfd_elf_version_expr *d;\n\n\t      len = p - h->root.root.string;\n\t      alc = (char *) bfd_malloc (len);\n\t      if (alc == NULL)\n\t\t{\n\t\t  sinfo->failed = TRUE;\n\t\t  return FALSE;\n\t\t}\n\t      memcpy (alc, h->root.root.string, len - 1);\n\t      alc[len - 1] = '\\0';\n\t      if (alc[len - 2] == ELF_VER_CHR)\n\t\talc[len - 2] = '\\0';\n\n\t      h->verinfo.vertree = t;\n\t      t->used = TRUE;\n\t      d = NULL;\n\n\t      if (t->globals.list != NULL)\n\t\td = (*t->match) (&t->globals, NULL, alc);\n\n\t      /* See if there is anything to force this symbol to\n\t\t local scope.  */\n\t      if (d == NULL && t->locals.list != NULL)\n\t\t{\n\t\t  d = (*t->match) (&t->locals, NULL, alc);\n\t\t  if (d != NULL\n\t\t      && h->dynindx != -1\n\t\t      && ! info->export_dynamic)\n\t\t    (*bed->elf_backend_hide_symbol) (info, h, TRUE);\n\t\t}\n\n\t      free (alc);\n\t      break;\n\t    }\n\t}\n\n      /* If we are building an application, we need to create a\n\t version node for this version.  */\n      if (t == NULL && info->executable)\n\t{\n\t  struct bfd_elf_version_tree **pp;\n\t  int version_index;\n\n\t  /* If we aren't going to export this symbol, we don't need\n\t     to worry about it.  */\n\t  if (h->dynindx == -1)\n\t    return TRUE;\n\n\t  amt = sizeof *t;\n\t  t = (struct bfd_elf_version_tree *) bfd_zalloc (info->output_bfd, amt);\n\t  if (t == NULL)\n\t    {\n\t      sinfo->failed = TRUE;\n\t      return FALSE;\n\t    }\n\n\t  t->name = p;\n\t  t->name_indx = (unsigned int) -1;\n\t  t->used = TRUE;\n\n\t  version_index = 1;\n\t  /* Don't count anonymous version tag.  */\n\t  if (sinfo->info->version_info != NULL\n\t      && sinfo->info->version_info->vernum == 0)\n\t    version_index = 0;\n\t  for (pp = &sinfo->info->version_info;\n\t       *pp != NULL;\n\t       pp = &(*pp)->next)\n\t    ++version_index;\n\t  t->vernum = version_index;\n\n"
}