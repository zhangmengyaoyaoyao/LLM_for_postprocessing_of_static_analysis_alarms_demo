{
    "project": "Zephyr",
    "tool": "Cppcheck",
    "category": "Null Pointer Dereference",
    "file": "subsys/net/ip/tcp2.c",
    "message": "Possible null pointer dereference: buf",
    "warning_function_name": "tcp_win_pop",
    "warning_line": "w->len -= buf->len;",
    "warning_context": "static struct net_buf *tcp_win_pop(struct tcp_win *w, const char *name,\n\t\t\t\t\tsize_t len)\n{\n\tstruct net_buf *buf, *out = NULL;\n\n\tNET_ASSERT_INFO(len, \"Invalid request, len: %zu\", len);\n\n\tNET_ASSERT_INFO(len <= w->len, \"Insufficient window length, \"\n\t\t\t\"len: %zu, req: %zu\", w->len, len);\n\twhile (len) {\n\n\t\tbuf = tcp_slist(&w->bufs, get, struct net_buf, user_data);\n\n\t\tw->len -= buf->len;\n\n\t\tout = out ? net_buf_frag_add(out, buf) : buf;\n\n\t\tlen -= buf->len;\n\t}\n\n\tNET_ASSERT_INFO(len == 0, \"Unfulfilled request, len: %zu\", len);\n\n\tNET_DBG(\"%s len=%zu\", name, net_buf_frags_len(out));\n\n\treturn out;\n}\n"
}