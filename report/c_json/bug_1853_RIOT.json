{
    "project": "RIOT",
    "tool": "Cppcheck",
    "category": "nullPointerArithmeticRedundantCheck",
    "file": "sys/net/gnrc/network_layer/icmpv6/echo/gnrc_icmpv6_echo.c",
    "message": "Either the condition 'echo==NULL' is redundant or there is pointer arithmetic with NULL pointer.",
    "warning_function_name": "gnrc_icmpv6_echo_req_handle",
    "warning_line": "uint8_t *payload = ((uint8_t *)echo) + sizeof(icmpv6_echo_t);",
    "warning_context": "void gnrc_icmpv6_echo_req_handle(gnrc_netif_t *netif, ipv6_hdr_t *ipv6_hdr,\n                                 icmpv6_echo_t *echo, uint16_t len)\n{\n    uint8_t *payload = ((uint8_t *)echo) + sizeof(icmpv6_echo_t);\n    gnrc_pktsnip_t *hdr, *pkt;\n\n    if ((echo == NULL) || (len < sizeof(icmpv6_echo_t))) {\n        DEBUG(\"icmpv6_echo: echo was NULL or len (%\" PRIu16\n              \") was < sizeof(icmpv6_echo_t)\\n\", len);\n        return;\n    }\n\n    pkt = gnrc_icmpv6_echo_build(ICMPV6_ECHO_REP, byteorder_ntohs(echo->id),\n                                 byteorder_ntohs(echo->seq), payload,\n                                 len - sizeof(icmpv6_echo_t));\n\n    if (pkt == NULL) {\n        DEBUG(\"icmpv6_echo: no space left in packet buffer\\n\");\n        return;\n    }\n\n    if (ipv6_addr_is_multicast(&ipv6_hdr->dst)) {\n        hdr = gnrc_ipv6_hdr_build(pkt, NULL, &ipv6_hdr->src);\n    }\n    else {\n        hdr = gnrc_ipv6_hdr_build(pkt, &ipv6_hdr->dst, &ipv6_hdr->src);\n    }\n\n    if (hdr == NULL) {\n        DEBUG(\"icmpv6_echo: no space left in packet buffer\\n\");\n        gnrc_pktbuf_release(pkt);\n        return;\n    }\n\n    pkt = hdr;\n    hdr = gnrc_netif_hdr_build(NULL, 0, NULL, 0);\n\n    if (hdr == NULL) {\n        DEBUG(\"icmpv6_echo: no space left in packet buffer\\n\");\n        gnrc_pktbuf_release(pkt);\n        return;\n    }\n    /* (netif == NULL) => ipv6_hdr->dst is loopback address */\n    gnrc_netif_hdr_set_netif(hdr->data, netif);\n\n    LL_PREPEND(pkt, hdr);\n\n    if (!gnrc_netapi_dispatch_send(GNRC_NETTYPE_IPV6, GNRC_NETREG_DEMUX_CTX_ALL,\n                                   pkt)) {\n        DEBUG(\"icmpv6_echo: no receivers for IPv6 packets\\n\");\n        gnrc_pktbuf_release(pkt);\n    }\n}\n"
}