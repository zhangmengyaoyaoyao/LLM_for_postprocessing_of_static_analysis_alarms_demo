{
    "project": "gawk",
    "tool": "CSA",
    "category": "core.NullDereference",
    "file": "builtin.c",
    "message": "Dereference of null pointer",
    "warning_function_name": NaN,
    "warning_line": "bchunk_one(\"%\");",
    "warning_context": "\t\tmsg(_(\"fatal: must use `count$' on all formats or none\")); \\\n\t\targ = 0; /* shutup the compiler */ \\\n\t\tgoto out; \\\n\t} else if (cur_arg >= num_args) { \\\n\t\targ = 0; /* shutup the compiler */ \\\n\t\ttoofew = true; \\\n\t\tbreak; \\\n\t} else { \\\n\t\targ = the_args[cur_arg]; \\\n\t\tcur_arg++; \\\n\t} \\\n}\n\n\tneed_format = false;\n\tused_dollar = false;\n\n\ts0 = s1 = fmt_string;\n\twhile (n0-- > 0) {\n\t\tif (*s1 != '%') {\n\t\t\ts1++;\n\t\t\tcontinue;\n\t\t}\n\t\tneed_format = true;\n\t\tbchunk(s0, s1 - s0);\n\t\ts0 = s1;\n\t\tcur = &fw;\n\t\tfw = 0;\n\t\tprec = 0;\n\t\tbase = 0;\n\t\targnum = 0;\n\t\tbase = 0;\n\t\thave_prec = false;\n\t\tsignchar = '\\0';\n\t\tzero_flag = false;\n\t\tquote_flag = false;\n#ifdef HAVE_MPFR\n\t\tmf = NULL;\n\t\tzi = NULL;\n#endif\n\t\tfmt_type = MP_NONE;\n\n\t\tlj = alt = big_flag = bigbig_flag = small_flag = false;\n\t\tfill = sp;\n\t\tcp = cend;\n\t\tchbuf = lchbuf;\n\t\ts1++;\n\nretry:\n\t\tif (n0-- == 0)\t/* ran out early! */\n\t\t\tbreak;\n\n\t\tswitch (cs1 = *s1++) {\n\t\tcase (-1):\t/* dummy case to allow for checking */\ncheck_pos:\n\t\t\tif (cur != &fw)\n\t\t\t\tbreak;\t\t/* reject as a valid format */\n\t\t\tgoto retry;\n\t\tcase '%':\n\t\t\tneed_format = false;\n\t\t\t/*\n\t\t\t * 29 Oct. 2002:\n\t\t\t * The C99 standard pages 274 and 279 seem to imply that\n\t\t\t * since there's no arg converted, the field width doesn't\n\t\t\t * apply.  The code already was that way, but this\n\t\t\t * comment documents it, at least in the code.\n\t\t\t */\n\t\t\tif (do_lint) {\n\t\t\t\tconst char *msg = NULL;\n\n\t\t\t\tif (fw && ! have_prec)\n\t\t\t\t\tmsg = _(\"field width is ignored for `%%' specifier\");\n\t\t\t\telse if (fw == 0 && have_prec)\n\t\t\t\t\tmsg = _(\"precision is ignored for `%%' specifier\");\n\t\t\t\telse if (fw && have_prec)\n\t\t\t\t\tmsg = _(\"field width and precision are ignored for `%%' specifier\");\n\n\t\t\t\tif (msg != NULL)\n\t\t\t\t\tlintwarn(\"%s\", msg);\n\t\t\t}\n\t\t\tbchunk_one(\"%\");\n\t\t\ts0 = s1;\n\t\t\tbreak;\n\n\t\tcase '0':\n\t\t\t/*\n\t\t\t * Only turn on zero_flag if we haven't seen\n\t\t\t * the field width or precision yet.  Otherwise,\n\t\t\t * screws up floating point formatting.\n\t\t\t */\n\t\t\tif (cur == & fw)\n\t\t\t\tzero_flag = true;\n\t\t\tif (lj)\n\t\t\t\tgoto retry;\n\t\t\t/* FALL through */\n\t\tcase '1':\n\t\tcase '2':\n\t\tcase '3':\n\t\tcase '4':\n\t\tcase '5':\n\t\tcase '6':\n\t\tcase '7':\n"
}