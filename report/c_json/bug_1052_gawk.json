{
    "Project": "gawk",
    "Tool": "Cppcheck",
    "category": "uninitvar",
    "file": "extension/gawkfts.c",
    "message": "Uninitialized variable: &sb",
    "warning_function_name": "fts_stat",
    "warning_line": "sbp = ISSET(FTS_NOSTAT) ? &sb : p->fts_statp;",
    "warning_context": "static unsigned short\nfts_stat(FTS *sp, FTSENT *p, int follow)\n{\n\tFTSENT *t;\n\tdev_t dev;\n\tino_t ino;\n\tstruct stat *sbp, sb;\n\tint saved_errno;\n\n\t_DIAGASSERT(sp != NULL);\n\t_DIAGASSERT(p != NULL);\n\n\t/* If user needs stat info, stat buffer already allocated. */\n\tsbp = ISSET(FTS_NOSTAT) ? &sb : p->fts_statp;\n\n#ifdef FTS_WHITEOUT\n\t/* check for whiteout */\n\tif (p->fts_flags & FTS_ISW) {\n\t\tif (sbp != &sb) {\n\t\t\tmemset(sbp, '\\0', sizeof (*sbp));\n\t\t\tsbp->st_mode = S_IFWHT;\n\t\t}\n\t\treturn (FTS_W);\n\t}\n#endif\n\n\t/*\n\t * If doing a logical walk, or application requested FTS_FOLLOW, do\n\t * a stat(2).  If that fails, check for a non-existent symlink.  If\n\t * fail, set the errno from the stat call.\n\t */\n\tif (ISSET(FTS_LOGICAL) || follow) {\n\t\tif (stat(p->fts_accpath, sbp)) {\n\t\t\tsaved_errno = errno;\n\t\t\tif (!lstat(p->fts_accpath, sbp)) {\n\t\t\t\terrno = 0;\n\t\t\t\treturn (FTS_SLNONE);\n\t\t\t}\n\t\t\tp->fts_errno = saved_errno;\n\t\t\tgoto err;\n\t\t}\n\t} else if (lstat(p->fts_accpath, sbp)) {\n\t\tp->fts_errno = errno;\nerr:\t\tmemset(sbp, 0, sizeof(*sbp));\n\t\treturn (FTS_NS);\n\t}\n\n\tif (S_ISDIR(sbp->st_mode)) {\n\t\t/*\n\t\t * Set the device/inode.  Used to find cycles and check for\n\t\t * crossing mount points.  Also remember the link count, used\n\t\t * in fts_build to limit the number of stat calls.  It is\n\t\t * understood that these fields are only referenced if fts_info\n\t\t * is set to FTS_D.\n\t\t */\n\t\tdev = p->fts_dev = sbp->st_dev;\n\t\tino = p->fts_ino = sbp->st_ino;\n\t\tp->fts_nlink = sbp->st_nlink;\n\n\t\tif (ISDOT(p->fts_name))\n\t\t\treturn (FTS_DOT);\n\n\t\t/*\n\t\t * Cycle detection is done by brute force when the directory\n\t\t * is first encountered.  If the tree gets deep enough or the\n\t\t * number of symbolic links to directories is high enough,\n\t\t * something faster might be worthwhile.\n\t\t */\n\t\tfor (t = p->fts_parent;\n\t\t    t->fts_level >= FTS_ROOTLEVEL; t = t->fts_parent)\n\t\t\tif (ino == t->fts_ino && dev == t->fts_dev) {\n\t\t\t\tp->fts_cycle = t;\n\t\t\t\treturn (FTS_DC);\n\t\t\t}\n\t\treturn (FTS_D);\n\t}\n\tif (S_ISLNK(sbp->st_mode))\n\t\treturn (FTS_SL);\n\tif (S_ISREG(sbp->st_mode))\n\t\treturn (FTS_F);\n\treturn (FTS_DEFAULT);\n}\n"
}