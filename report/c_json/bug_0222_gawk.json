{
    "Project": "gawk",
    "Tool": "Infer",
    "Bug Type": "NULL_DEREFERENCE",
    "Message": "pointer `file_awk` last assigned on line 2708 could be null and is dereferenced by call to `sprintf()` at line 2710, column 3.",
    "Code_line": "\t\tsprintf(file_awk, \"%s%s\", src, DEFAULT_FILETYPE);",
    "Code_function": "find_source(const char *src, struct stat *stb, int *errcode, int is_extlib)\n{\n\tchar *path;\n\tpath_info *pi = (is_extlib ? & pi_awklibpath : & pi_awkpath);\n\n\t*errcode = 0;\n\tif (src == NULL || *src == '\\0')\n\t\treturn NULL;\n\tpath = do_find_source(src, stb, errcode, pi);\n\n\tif (path == NULL && is_extlib) {\n\t\tchar *file_ext;\n\t\tint save_errno;\n\t\tsize_t src_len;\n\t\tsize_t suffix_len;\n\n#define EXTLIB_SUFFIX\t\".\" SHLIBEXT\n\t\tsrc_len = strlen(src);\n\t\tsuffix_len = strlen(EXTLIB_SUFFIX);\n\n\t\t/* check if already has the SUFFIX */\n\t\tif (src_len >= suffix_len && strcmp(& src[src_len - suffix_len], EXTLIB_SUFFIX) == 0)\n\t\t\treturn NULL;\n\n\t\t/* append EXTLIB_SUFFIX and try again */\n\t\tsave_errno = errno;\n\t\temalloc(file_ext, char *, src_len + suffix_len + 1, \"find_source\");\n\t\tsprintf(file_ext, \"%s%s\", src, EXTLIB_SUFFIX);\n\t\tpath = do_find_source(file_ext, stb, errcode, pi);\n\t\tefree(file_ext);\n\t\tif (path == NULL)\n\t\t\terrno = save_errno;\n\t\treturn path;\n#undef EXTLIB_SUFFIX\n\t}\n\n/*\n * Try searching with .awk appended if the platform headers have not specified\n * another suffix.\n */\n#ifndef DEFAULT_FILETYPE\n#define DEFAULT_FILETYPE \".awk\"\n#endif\n\n#ifdef DEFAULT_FILETYPE\n\tif (! do_traditional && path == NULL) {\n\t\tchar *file_awk;\n\t\tint save_errno = errno;\n#ifdef VMS\n\t\tint vms_save = vaxc$errno;\n#endif\n\n\t\t/* append \".awk\" and try again */\n\t\temalloc(file_awk, char *, strlen(src) +\n\t\t\tsizeof(DEFAULT_FILETYPE) + 1, \"find_source\");\n\t\tsprintf(file_awk, \"%s%s\", src, DEFAULT_FILETYPE);\n\t\tpath = do_find_source(file_awk, stb, errcode, pi);\n\t\tefree(file_awk);\n\t\tif (path == NULL) {\n\t\t\terrno = save_errno;\n#ifdef VMS\n\t\t\tvaxc$errno = vms_save;\n#endif\n\t\t}\n\t}\n#endif\t/*DEFAULT_FILETYPE*/\n\n\treturn path;\n}"
}