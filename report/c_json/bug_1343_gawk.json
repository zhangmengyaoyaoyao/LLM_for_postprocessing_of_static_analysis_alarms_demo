{
    "project": "gawk",
    "tool": "Infer",
    "category": "NULL_DEREFERENCE",
    "file": "awkgram.y",
    "message": "pointer `tp` last assigned on line 5232 could be null and is dereferenced at line 5236, column 7.",
    "warning_function_name": "mk_getline",
    "warning_line": "if (tp->opcode == Op_push_lhs",
    "warning_context": "static INSTRUCTION *\nmk_getline(INSTRUCTION *op, INSTRUCTION *var, INSTRUCTION *redir, int redirtype)\n{\n\tINSTRUCTION *ip;\n\tINSTRUCTION *tp;\n\tINSTRUCTION *asgn = NULL;\n\n\t/*\n\t *  getline [var] < [file]\n\t *\n\t *  [ file (simp_exp)]\n\t *  [ [ var ] ]\n\t *  [ Op_K_getline_redir|NULL|redir_type|into_var]\n\t *  [ [var_assign] ] \n\t *\n\t */\n\n\tif (redir == NULL) {\n\t\tint sline = op->source_line;\n\t\tbcfree(op);\n\t\top = bcalloc(Op_K_getline, 2, sline);\n\t\t(op + 1)->target_endfile = ip_endfile;\n\t\t(op + 1)->target_beginfile = ip_beginfile;\t\n\t}\n\n\tif (var != NULL) {\n\t\ttp = make_assignable(var->lasti);\n\t\tassert(tp != NULL);\n\n\t\t/* check if we need after_assign bytecode */\n\t\tif (tp->opcode == Op_push_lhs\n\t\t\t\t&& tp->memory->type == Node_var\n\t\t\t\t&& tp->memory->var_assign\n\t\t) {\n\t\t\tasgn = instruction(Op_var_assign);\n\t\t\tasgn->assign_ctxt = op->opcode;\n\t\t\tasgn->assign_var = tp->memory->var_assign;\n\t\t} else if (tp->opcode == Op_field_spec_lhs) {\n\t\t\tasgn = instruction(Op_field_assign);\n\t\t\tasgn->assign_ctxt = op->opcode;\n\t\t\tasgn->field_assign = (Func_ptr) 0;   /* determined at run time */\n\t\t\ttp->target_assign = asgn;\n\t\t} else if (tp->opcode == Op_subscript_lhs) {\n\t\t\tasgn = instruction(Op_subscript_assign);\n\t\t\tasgn->assign_ctxt = op->opcode;\n\t\t}\n\n\t\tif (redir != NULL) {\n\t\t\tip = list_merge(redir, var);\n\t\t\t(void) list_append(ip, op);\n\t\t} else\n\t\t\tip = list_append(var, op);\n\t} else if (redir != NULL)\n\t\tip = list_append(redir, op);\n\telse\n\t\tip = list_create(op);\n\top->into_var = (var != NULL);\n\top->redir_type = (redir != NULL) ? redirtype : redirect_none;\n\n\treturn (asgn == NULL ? ip : list_append(ip, asgn));\n}\n"
}