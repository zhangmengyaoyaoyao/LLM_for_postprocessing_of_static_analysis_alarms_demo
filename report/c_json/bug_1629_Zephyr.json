{
    "Project": "Zephyr",
    "Tool": "Cppcheck",
    "category": "Null Pointer Dereference",
    "file": "subsys/bluetooth/controller/ll_sw/ctrl.c",
    "message": "Either the condition '!node_tx' is redundant or there is possible null pointer dereference: node_tx.",
    "warning_function_name": "tx_cmplt_get",
    "warning_line": "pdu_data_tx = (void *)node_tx->pdu_data;",
    "warning_context": "static u8_t tx_cmplt_get(u16_t *handle, u8_t *first, u8_t last)\n{\n\tu8_t _first;\n\tu8_t cmplt;\n\n\t_first = *first;\n\tif (_first == last) {\n\t\treturn 0;\n\t}\n\n\tcmplt = 0U;\n\t*handle = _radio.pkt_release[_first].handle;\n\tdo {\n\t\tstruct radio_pdu_node_tx *node_tx;\n\t\tstruct pdu_data *pdu_data_tx;\n\n\t\tif (*handle != _radio.pkt_release[_first].handle) {\n\t\t\tbreak;\n\t\t}\n\n\t\tnode_tx = _radio.pkt_release[_first].node_tx;\n\t\t/*@FIXME: assign before first 3 if conditions */\n\t\tpdu_data_tx = (void *)node_tx->pdu_data;\n\t\tif ((!node_tx) || (node_tx == (void *)1) ||\n\t\t    ((((u32_t)node_tx & ~(0x00000003)) != 0) &&\n\t\t     (pdu_data_tx) && (pdu_data_tx->len != 0) &&\n\t\t     ((pdu_data_tx->ll_id == PDU_DATA_LLID_DATA_START) ||\n\t\t      (pdu_data_tx->ll_id == PDU_DATA_LLID_DATA_CONTINUE)))) {\n\n\t\t\t/* data packet, hence count num cmplt */\n\t\t\t_radio.pkt_release[_first].node_tx = (void *)1;\n\n\t\t\tcmplt++;\n\t\t} else {\n\t\t\t/* ctrl packet, hence not num cmplt */\n\t\t\t_radio.pkt_release[_first].node_tx = (void *)2;\n\t\t}\n\n\t\tif (((u32_t)node_tx & ~(0x00000003)) != 0) {\n\t\t\tmem_release(node_tx, &_radio.pkt_tx_data_free);\n\t\t}\n\n\t\t_first = _first + 1;\n\t\tif (_first == _radio.packet_tx_count) {\n\t\t\t_first = 0U;\n\t\t}\n\n\t} while (_first != last);\n\n\t*first = _first;\n\n\treturn cmplt;\n}\n"
}