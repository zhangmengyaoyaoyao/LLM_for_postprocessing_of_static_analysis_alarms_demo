{
    "Project": "Zephyr",
    "Tool": "Cppcheck",
    "category": "Uninitialized Variable",
    "file": "subsys/net/ip/connection.c",
    "message": "Uninitialized variable: conn->proto",
    "warning_function_name": "conn_find_handler",
    "warning_line": "if (conn->proto != proto) {",
    "warning_context": "static struct net_conn *conn_find_handler(u16_t proto, u8_t family,\n\t\t\t\t\t  const struct sockaddr *remote_addr,\n\t\t\t\t\t  const struct sockaddr *local_addr,\n\t\t\t\t\t  u16_t remote_port,\n\t\t\t\t\t  u16_t local_port)\n{\n\tstruct net_conn *conn;\n\n\tSYS_SLIST_FOR_EACH_CONTAINER(&conn_used, conn, node) {\n\t\tif (conn->proto != proto) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (conn->family != family) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (remote_addr) {\n\t\t\tif (!(conn->flags & NET_CONN_REMOTE_ADDR_SET)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (IS_ENABLED(CONFIG_NET_IPV6) &&\n\t\t\t    remote_addr->sa_family == AF_INET6 &&\n\t\t\t    remote_addr->sa_family ==\n\t\t\t    conn->remote_addr.sa_family) {\n\t\t\t\tif (!net_ipv6_addr_cmp(\n\t\t\t\t\t    &net_sin6(remote_addr)->sin6_addr,\n\t\t\t\t\t    &net_sin6(&conn->remote_addr)->\n\t\t\t\t\t\t\t\tsin6_addr)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t} else if (IS_ENABLED(CONFIG_NET_IPV4) &&\n\t\t\t\t   remote_addr->sa_family == AF_INET &&\n\t\t\t\t   remote_addr->sa_family ==\n\t\t\t\t   conn->remote_addr.sa_family) {\n\t\t\t\tif (!net_ipv4_addr_cmp(\n\t\t\t\t\t    &net_sin(remote_addr)->sin_addr,\n\t\t\t\t\t    &net_sin(&conn->remote_addr)->\n\t\t\t\t\t\t\t\tsin_addr)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t} else if (conn->flags & NET_CONN_REMOTE_ADDR_SET) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (local_addr) {\n\t\t\tif (!(conn->flags & NET_CONN_LOCAL_ADDR_SET)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (IS_ENABLED(CONFIG_NET_IPV6) &&\n\t\t\t    local_addr->sa_family == AF_INET6 &&\n\t\t\t    local_addr->sa_family ==\n\t\t\t    conn->local_addr.sa_family) {\n\t\t\t\tif (!net_ipv6_addr_cmp(\n\t\t\t\t\t    &net_sin6(local_addr)->sin6_addr,\n\t\t\t\t\t    &net_sin6(&conn->local_addr)->\n\t\t\t\t\t\t\t\tsin6_addr)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t} else if (IS_ENABLED(CONFIG_NET_IPV4) &&\n\t\t\t\t   local_addr->sa_family == AF_INET &&\n\t\t\t\t   local_addr->sa_family ==\n\t\t\t\t   conn->local_addr.sa_family) {\n\t\t\t\tif (!net_ipv4_addr_cmp(\n\t\t\t\t\t    &net_sin(local_addr)->sin_addr,\n\t\t\t\t\t    &net_sin(&conn->local_addr)->\n\t\t\t\t\t\t\t\tsin_addr)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t} else if (conn->flags & NET_CONN_LOCAL_ADDR_SET) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (net_sin(&conn->remote_addr)->sin_port !=\n\t\t    htons(remote_port)) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (net_sin(&conn->local_addr)->sin_port !=\n\t\t    htons(local_port)) {\n\t\t\tcontinue;\n\t\t}\n\n\t\treturn conn;\n\t}\n\n\treturn NULL;\n}\n"
}