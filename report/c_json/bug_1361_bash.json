{
    "Project": "bash",
    "Tool": "Infer",
    "Bug Type": "BUFFER_OVERRUN_L2",
    "Message": "Offset: [1, 73] Size: 4 by call to `print_formatted_time`.",
    "Code_line": "    print_formatted_time (stderr, time_format, rs, rsf, us, usf, ss, ssf, cpu);",
    "Code_function": "time_command (command, asynchronous, pipe_in, pipe_out, fds_to_close)\n     COMMAND *command;\n     int asynchronous, pipe_in, pipe_out;\n     struct fd_bitmap *fds_to_close;\n{\n  int rv, posix_time, old_flags, nullcmd;\n  time_t rs, us, ss;\n  int rsf, usf, ssf;\n  int cpu;\n  char *time_format;\n\n#if defined (HAVE_GETRUSAGE) && defined (HAVE_GETTIMEOFDAY)\n  struct timeval real, user, sys;\n  struct timeval before, after;\n#  if defined (HAVE_STRUCT_TIMEZONE)\n  struct timezone dtz;\t\t\t\t/* posix doesn't define this */\n#  endif\n  struct rusage selfb, selfa, kidsb, kidsa;\t/* a = after, b = before */\n#else\n#  if defined (HAVE_TIMES)\n  clock_t tbefore, tafter, real, user, sys;\n  struct tms before, after;\n#  endif\n#endif\n\n#if defined (HAVE_GETRUSAGE) && defined (HAVE_GETTIMEOFDAY)\n#  if defined (HAVE_STRUCT_TIMEZONE)\n  gettimeofday (&before, &dtz);\n#  else\n  gettimeofday (&before, (void *)NULL);\n#  endif /* !HAVE_STRUCT_TIMEZONE */\n  getrusage (RUSAGE_SELF, &selfb);\n  getrusage (RUSAGE_CHILDREN, &kidsb);\n#else\n#  if defined (HAVE_TIMES)\n  tbefore = times (&before);\n#  endif\n#endif\n\n  posix_time = command && (command->flags & CMD_TIME_POSIX);\n\n  nullcmd = (command == 0) || (command->type == cm_simple && command->value.Simple->words == 0 && command->value.Simple->redirects == 0);\n  if (posixly_correct && nullcmd)\n    {\n#if defined (HAVE_GETRUSAGE)\n      selfb.ru_utime.tv_sec = kidsb.ru_utime.tv_sec = selfb.ru_stime.tv_sec = kidsb.ru_stime.tv_sec = 0;\n      selfb.ru_utime.tv_usec = kidsb.ru_utime.tv_usec = selfb.ru_stime.tv_usec = kidsb.ru_stime.tv_usec = 0;\n      before.tv_sec = shell_start_time;\n      before.tv_usec = 0;\n#else\n      before.tms_utime = before.tms_stime = before.tms_cutime = before.tms_cstime = 0;\n      tbefore = shell_start_time;\n#endif\n    }\n\n  old_flags = command->flags;\n  command->flags &= ~(CMD_TIME_PIPELINE|CMD_TIME_POSIX);\n  rv = execute_command_internal (command, asynchronous, pipe_in, pipe_out, fds_to_close);\n  command->flags = old_flags;\n\n  rs = us = ss = 0;\n  rsf = usf = ssf = cpu = 0;\n\n#if defined (HAVE_GETRUSAGE) && defined (HAVE_GETTIMEOFDAY)\n#  if defined (HAVE_STRUCT_TIMEZONE)\n  gettimeofday (&after, &dtz);\n#  else\n  gettimeofday (&after, (void *)NULL);\n#  endif /* !HAVE_STRUCT_TIMEZONE */\n  getrusage (RUSAGE_SELF, &selfa);\n  getrusage (RUSAGE_CHILDREN, &kidsa);\n\n  difftimeval (&real, &before, &after);\n  timeval_to_secs (&real, &rs, &rsf);\n\n  addtimeval (&user, difftimeval(&after, &selfb.ru_utime, &selfa.ru_utime),\n\t\t     difftimeval(&before, &kidsb.ru_utime, &kidsa.ru_utime));\n  timeval_to_secs (&user, &us, &usf);\n\n  addtimeval (&sys, difftimeval(&after, &selfb.ru_stime, &selfa.ru_stime),\n\t\t    difftimeval(&before, &kidsb.ru_stime, &kidsa.ru_stime));\n  timeval_to_secs (&sys, &ss, &ssf);\n\n  cpu = timeval_to_cpu (&real, &user, &sys);\n#else\n#  if defined (HAVE_TIMES)\n  tafter = times (&after);\n\n  real = tafter - tbefore;\n  clock_t_to_secs (real, &rs, &rsf);\n\n  user = (after.tms_utime - before.tms_utime) + (after.tms_cutime - before.tms_cutime);\n  clock_t_to_secs (user, &us, &usf);\n\n  sys = (after.tms_stime - before.tms_stime) + (after.tms_cstime - before.tms_cstime);\n  clock_t_to_secs (sys, &ss, &ssf);\n\n  cpu = (real == 0) ? 0 : ((user + sys) * 10000) / real;\n\n#  else\n  rs = us = ss = 0;\n  rsf = usf = ssf = cpu = 0;\n#  endif\n#endif\n\n  if (posix_time)\n    time_format = POSIX_TIMEFORMAT;\n  else if ((time_format = get_string_value (\"TIMEFORMAT\")) == 0)\n    {\n      if (posixly_correct && nullcmd)\n\ttime_format = \"user\\t%2lU\\nsys\\t%2lS\";\n      else\n\ttime_format = BASH_TIMEFORMAT;\n    }\n  if (time_format && *time_format)\n    print_formatted_time (stderr, time_format, rs, rsf, us, usf, ss, ssf, cpu);\n\n  return rv;\n}"
}