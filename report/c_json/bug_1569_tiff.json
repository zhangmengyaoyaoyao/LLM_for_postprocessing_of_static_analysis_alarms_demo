{
    "Project": "tiff",
    "Tool": "Infer",
    "category": "NULL_DEREFERENCE",
    "file": "tools/tiff2pdf.c",
    "message": "pointer `currenttime` last assigned on line 4032 could be null and is dereferenced at line 4035, column 5.",
    "warning_function_name": "t2p_pdf_currenttime",
    "warning_line": "(currenttime->tm_year + 1900) % 65536,",
    "warning_context": "void t2p_pdf_currenttime(T2P* t2p)\n{\n\tstruct tm* currenttime;\n\ttime_t timenow;\n\n\tif (time(&timenow) == (time_t) -1) {\n\t\tTIFFError(TIFF2PDF_MODULE,\n\t\t\t  \"Can't get the current time: %s\", strerror(errno));\n\t\ttimenow = (time_t) 0;\n\t}\n\n\tcurrenttime = localtime(&timenow);\n\tsnprintf(t2p->pdf_datetime, sizeof(t2p->pdf_datetime),\n\t\t \"D:%.4d%.2d%.2d%.2d%.2d%.2d\",\n\t\t (currenttime->tm_year + 1900) % 65536,\n\t\t (currenttime->tm_mon + 1) % 256,\n\t\t(currenttime->tm_mday) % 256, \n\t\t(currenttime->tm_hour) % 256, \n\t\t(currenttime->tm_min) % 256, \n\t\t(currenttime->tm_sec) % 256);\n\n\treturn;\n}\n"
}