{
    "Project": "Zephyr",
    "Tool": "Infer",
    "category": "Uninitialized Value",
    "file": "subsys/dfu/boot/mcuboot.c",
    "message": "The value read from rc was never initialized.",
    "warning_function_name": NaN,
    "warning_line": "return rc;",
    "warning_context": "/* equivalent of boot_swap_type() in mcuboot bootutil_misc.c */\nint mcuboot_swap_type(void)\n{\n\tconst struct boot_swap_table *table;\n\tstruct boot_swap_state primary_slot;\n\tstruct boot_swap_state secondary_slot;\n\tint rc;\n\tsize_t i;\n\n\trc = boot_read_swap_state_by_id(FLASH_AREA_IMAGE_PRIMARY,\n\t\t\t\t\t&primary_slot);\n\tif (rc) {\n\t\treturn rc;\n\t}\n\n\trc = boot_read_swap_state_by_id(FLASH_AREA_IMAGE_SECONDARY,\n\t\t\t\t\t&secondary_slot);\n\tif (rc) {\n\t\treturn rc;\n\t}\n\n\tfor (i = 0; i < BOOT_SWAP_TABLES_COUNT; i++) {\n\t\ttable = boot_swap_tables + i;\n\n\t\tif (boot_magic_compatible_check(table->magic_primary_slot,\n\t\t\t\t\t\tprimary_slot.magic)\n\t\t    &&\n\t\t    boot_magic_compatible_check(table->magic_secondary_slot,\n\t\t\t\t\t\tsecondary_slot.magic)\n\t\t    &&\n\t\t    (table->image_ok_primary_slot == BOOT_FLAG_ANY   ||\n\t\t     table->image_ok_primary_slot == primary_slot.image_ok)\n\t\t    &&\n\t\t    (table->image_ok_secondary_slot == BOOT_FLAG_ANY ||\n\t\t     table->image_ok_secondary_slot == secondary_slot.image_ok)\n\t\t    &&\n\t\t    (table->copy_done_primary_slot == BOOT_FLAG_ANY  ||\n\t\t     table->copy_done_primary_slot == primary_slot.copy_done)) {\n\n\t\t\tassert(table->swap_type == BOOT_SWAP_TYPE_TEST ||\n\t\t\t       table->swap_type == BOOT_SWAP_TYPE_PERM ||\n\t\t\t       table->swap_type == BOOT_SWAP_TYPE_REVERT);\n\t\t\treturn table->swap_type;\n\t\t}\n\t}\n\n\treturn BOOT_SWAP_TYPE_NONE;\n}\n\nint boot_request_upgrade(int permanent)\n{\n#ifdef CONFIG_MCUBOOT_TRAILER_SWAP_TYPE\n\tu8_t swap_type;\n#endif\n\tint rc;\n\n\trc = boot_magic_write(FLASH_AREA_IMAGE_SECONDARY);\n\tif (rc) {\n\t\tgoto op_end;\n\t}\n\n\tif (permanent) {\n\t\trc = boot_image_ok_write(FLASH_AREA_IMAGE_SECONDARY);\n\n#ifdef CONFIG_MCUBOOT_TRAILER_SWAP_TYPE\n\t\tif (rc) {\n\t\t\tgoto op_end;\n\t\t}\n\n\t\tswap_type = BOOT_SWAP_TYPE_PERM;\n\t} else {\n\t\tswap_type = BOOT_SWAP_TYPE_TEST;\n\t}\n\n\trc = boot_swap_type_write(FLASH_AREA_IMAGE_SECONDARY, swap_type);\n#else\n\t}\n#endif\nop_end:\n\treturn rc;\n}\n\nbool boot_is_img_confirmed(void)\n{\n\treturn boot_image_ok_read(FLASH_AREA_IMAGE_PRIMARY) == BOOT_FLAG_SET;\n}\n\nint boot_write_img_confirmed(void)\n{\n\tint rc;\n\n\tif (boot_image_ok_read(FLASH_AREA_IMAGE_PRIMARY) !=\n\t    erased_flag_val(FLASH_AREA_IMAGE_PRIMARY)) {\n\t\t/* Already confirmed. */\n\t\treturn 0;\n\t}\n\n\trc = boot_image_ok_write(FLASH_AREA_IMAGE_PRIMARY);\n\n\treturn rc;\n}\n"
}