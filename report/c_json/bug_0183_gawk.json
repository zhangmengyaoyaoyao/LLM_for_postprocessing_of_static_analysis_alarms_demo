{
    "Project": "gawk",
    "Tool": "Infer",
    "Bug Type": "BUFFER_OVERRUN_L3",
    "Message": "Offset added: 4 Size: [0, 6] by call to `update_PROCINFO_str`.",
    "Code_line": "\tupdate_PROCINFO_str(\"FS\", \"FPAT\");",
    "Code_function": "set_FPAT()\n{\n\tstatic bool warned = false;\n\tstatic NODE *save_fpat = NULL;\n\tbool remake_re = true;\n\tNODE *fpat;\n\n\tif (do_lint && ! warned) {\n\t\twarned = true;\n\t\tlintwarn(_(\"`FPAT' is a gawk extension\"));\n\t}\n\tif (do_traditional)\t/* quick and dirty, does the trick */\n\t\treturn;\n\n\t/*\n\t * If changing the way fields are split, obey least-suprise\n\t * semantics, and force $0 to be split totally.\n\t */\n\tif (fields_arr != NULL)\n\t\t(void) get_field(UNLIMITED - 1, 0);\n\n\t/* It's possible that only IGNORECASE changed, or FPAT = FPAT */\n\t/*\n\t * This comparison can't use cmp_nodes(), which pays attention\n\t * to IGNORECASE, and that's not what we want.\n\t */\n\tif (save_fpat\n\t\t&& FPAT_node->var_value->stlen == save_fpat->stlen\n\t\t&& memcmp(FPAT_node->var_value->stptr, save_fpat->stptr, save_fpat->stlen) == 0) {\n\t\tif (FPAT_regexp != NULL)\n\t\t\tFPAT_regexp = (IGNORECASE ? FPAT_re_no_case : FPAT_re_yes_case);\n\n\t\t/* FPAT = FPAT */\n\t\tif (current_field_sep() == Using_FPAT) {\n\t\t\treturn;\n\t\t} else {\n\t\t\tremake_re = false;\n\t\t\tgoto set_fpat_function;\n\t\t}\n\t}\n\n\tunref(save_fpat);\n\tsave_fpat = dupnode(FPAT_node->var_value);\n\trefree(FPAT_re_yes_case);\n\trefree(FPAT_re_no_case);\n\tFPAT_re_yes_case = FPAT_re_no_case = FPAT_regexp = NULL;\n\nset_fpat_function:\n\tfpat = force_string(FPAT_node->var_value);\n\tparse_field = fpat_parse_field;\n\n\tif (remake_re) {\n\t\trefree(FPAT_re_yes_case);\n\t\trefree(FPAT_re_no_case);\n\t\tFPAT_re_yes_case = FPAT_re_no_case = FPAT_regexp = NULL;\n\n\t\tFPAT_re_yes_case = make_regexp(fpat->stptr, fpat->stlen, false, true, true);\n\t\tFPAT_re_no_case = make_regexp(fpat->stptr, fpat->stlen, true, true, true);\n\t\tFPAT_regexp = (IGNORECASE ? FPAT_re_no_case : FPAT_re_yes_case);\n\t}\n\n\tupdate_PROCINFO_str(\"FS\", \"FPAT\");\n}"
}