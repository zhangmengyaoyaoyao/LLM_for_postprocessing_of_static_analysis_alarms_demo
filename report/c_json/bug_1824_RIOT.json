{
    "Project": "RIOT",
    "Tool": "Infer",
    "Bug Type": "Null Dereference",
    "Code_line": "    if (icmpv6->size < sizeof(icmpv6_hdr_t)) {",
    "Code_function": "void gnrc_icmpv6_demux(gnrc_netif_t *netif, gnrc_pktsnip_t *pkt)\n{\n    gnrc_pktsnip_t *icmpv6, *ipv6;\n    icmpv6_hdr_t *hdr;\n\n    icmpv6 = gnrc_pktsnip_search_type(pkt, GNRC_NETTYPE_ICMPV6);\n\n    assert(icmpv6 != NULL);\n\n    /* there can be extension headers between IPv6 and ICMPv6 header so we have\n     * to search it */\n    ipv6 = gnrc_pktsnip_search_type(icmpv6, GNRC_NETTYPE_IPV6);\n\n    assert(ipv6 != NULL);\n\n    if (icmpv6->size < sizeof(icmpv6_hdr_t)) {\n        DEBUG(\"icmpv6: packet too short.\\n\");\n        gnrc_pktbuf_release(pkt);\n        return;\n    }\n\n    /* Note: size will be checked again in packet handlers */\n\n    hdr = (icmpv6_hdr_t *)icmpv6->data;\n\n    if (_calc_csum(icmpv6, ipv6, pkt)) {\n        DEBUG(\"icmpv6: wrong checksum.\\n\");\n        gnrc_pktbuf_release(pkt);\n        return;\n    }\n\n    switch (hdr->type) {\n        /* TODO: handle ICMPv6 errors */\n#ifdef MODULE_GNRC_ICMPV6_ECHO\n        case ICMPV6_ECHO_REQ:\n            DEBUG(\"icmpv6: handle echo request.\\n\");\n            gnrc_icmpv6_echo_req_handle(netif, (ipv6_hdr_t *)ipv6->data,\n                                        (icmpv6_echo_t *)hdr, icmpv6->size);\n            break;\n#endif\n\n        case ICMPV6_RTR_SOL:\n        case ICMPV6_RTR_ADV:\n        case ICMPV6_NBR_SOL:\n        case ICMPV6_NBR_ADV:\n        case ICMPV6_REDIRECT:\n        case ICMPV6_DAR:\n        case ICMPV6_DAC:\n            DEBUG(\"icmpv6: NDP message received. Handle with gnrc_ipv6_nib\\n\");\n            gnrc_ipv6_nib_handle_pkt(netif, ipv6->data, hdr, icmpv6->size);\n            break;\n\n        default:\n            DEBUG(\"icmpv6: unknown type field %u\\n\", hdr->type);\n            (void)netif;\n            break;\n    }\n\n    /* ICMPv6-all will be send in gnrc_ipv6.c so only dispatch of subtypes is\n     * needed */\n    if (!gnrc_netapi_dispatch_receive(GNRC_NETTYPE_ICMPV6, hdr->type, pkt)) {\n        DEBUG(\"icmpv6: no one interested in type %d\\n\", hdr->type);\n        gnrc_pktbuf_release(pkt);\n    }\n}"
}