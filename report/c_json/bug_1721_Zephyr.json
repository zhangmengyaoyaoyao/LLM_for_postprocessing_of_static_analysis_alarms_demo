{
    "Project": "Zephyr",
    "Tool": "Infer",
    "category": "Null Dereference",
    "file": "subsys/bluetooth/host/hci_core.c",
    "message": "pointer `null` is dereferenced by call to `bt_hci_cmd_send_sync()` at line 990, column 8.",
    "warning_function_name": "hci_le_set_data_len",
    "warning_line": "err = bt_hci_cmd_send_sync(BT_HCI_OP_LE_READ_MAX_DATA_LEN, NULL, &rsp);",
    "warning_context": "static void hci_le_set_data_len(struct bt_conn *conn)\n{\n\tstruct bt_hci_rp_le_read_max_data_len *rp;\n\tstruct bt_hci_cp_le_set_data_len *cp;\n\tstruct net_buf *buf, *rsp;\n\tu16_t tx_octets, tx_time;\n\tint err;\n\n\terr = bt_hci_cmd_send_sync(BT_HCI_OP_LE_READ_MAX_DATA_LEN, NULL, &rsp);\n\tif (err) {\n\t\tBT_ERR(\"Failed to read DLE max data len\");\n\t\treturn;\n\t}\n\n\trp = (void *)rsp->data;\n\ttx_octets = sys_le16_to_cpu(rp->max_tx_octets);\n\ttx_time = sys_le16_to_cpu(rp->max_tx_time);\n\tnet_buf_unref(rsp);\n\n\tbuf = bt_hci_cmd_create(BT_HCI_OP_LE_SET_DATA_LEN, sizeof(*cp));\n\tif (!buf) {\n\t\tBT_ERR(\"Failed to create LE Set Data Length Command\");\n\t\treturn;\n\t}\n\n\tcp = net_buf_add(buf, sizeof(*cp));\n\tcp->handle = sys_cpu_to_le16(conn->handle);\n\tcp->tx_octets = sys_cpu_to_le16(tx_octets);\n\tcp->tx_time = sys_cpu_to_le16(tx_time);\n\terr = bt_hci_cmd_send(BT_HCI_OP_LE_SET_DATA_LEN, buf);\n\tif (err) {\n\t\tBT_ERR(\"Failed to send LE Set Data Length Command\");\n\t}\n}\n"
}