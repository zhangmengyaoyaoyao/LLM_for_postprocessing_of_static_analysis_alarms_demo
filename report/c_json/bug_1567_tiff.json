{
    "Project": "tiff",
    "Tool": "Infer",
    "category": "BUFFER_OVERRUN_L3",
    "file": "tools/tiff2ps.c",
    "message": "Offset: [1, +oo] Size: [0, +oo] by call to `PSDataColorContig`.",
    "warning_function_name": "PSpage",
    "warning_line": "PSDataColorContig(fd, tif, w, h, 3);",
    "warning_context": "void\nPSpage(FILE* fd, TIFF* tif, uint32 w, uint32 h)\n{\n\tchar\t*\timageOp = \"image\";\n\n\tif ( useImagemask && (bitspersample == 1) )\n\t\timageOp = \"imagemask\";\n\n\tif ((level2 || level3) && PS_Lvl2page(fd, tif, w, h))\n\t\treturn;\n\tps_bytesperrow = tf_bytesperrow - (extrasamples * bitspersample / 8)*w;\n\tswitch (photometric) {\n\tcase PHOTOMETRIC_RGB:\n\t\tif (planarconfiguration == PLANARCONFIG_CONTIG) {\n\t\t\tfprintf(fd, \"%s\", RGBcolorimage);\n\t\t\tPSColorContigPreamble(fd, w, h, 3);\n\t\t\tPSDataColorContig(fd, tif, w, h, 3);\n\t\t} else {\n\t\t\tPSColorSeparatePreamble(fd, w, h, 3);\n\t\t\tPSDataColorSeparate(fd, tif, w, h, 3);\n\t\t}\n\t\tbreak;\n\tcase PHOTOMETRIC_SEPARATED:\n\t\t/* XXX should emit CMYKcolorimage */\n\t\tif (planarconfiguration == PLANARCONFIG_CONTIG) {\n\t\t\tPSColorContigPreamble(fd, w, h, 4);\n\t\t\tPSDataColorContig(fd, tif, w, h, 4);\n\t\t} else {\n\t\t\tPSColorSeparatePreamble(fd, w, h, 4);\n\t\t\tPSDataColorSeparate(fd, tif, w, h, 4);\n\t\t}\n\t\tbreak;\n\tcase PHOTOMETRIC_PALETTE:\n\t\tfprintf(fd, \"%s\", RGBcolorimage);\n\t\tPhotoshopBanner(fd, w, h, 1, 3, \"false 3 colorimage\");\n\t\tfprintf(fd, \"/scanLine %ld string def\\n\",\n\t\t    (long) ps_bytesperrow * 3L);\n\t\tfprintf(fd, \"%lu %lu 8\\n\",\n\t\t    (unsigned long) w, (unsigned long) h);\n\t\tfprintf(fd, \"[%lu 0 0 -%lu 0 %lu]\\n\",\n\t\t    (unsigned long) w, (unsigned long) h, (unsigned long) h);\n\t\tfprintf(fd, \"{currentfile scanLine readhexstring pop} bind\\n\");\n\t\tfprintf(fd, \"false 3 colorimage\\n\");\n\t\tPSDataPalette(fd, tif, w, h);\n\t\tbreak;\n\tcase PHOTOMETRIC_MINISBLACK:\n\tcase PHOTOMETRIC_MINISWHITE:\n\t\tPhotoshopBanner(fd, w, h, 1, 1, imageOp);\n\t\tfprintf(fd, \"/scanLine %ld string def\\n\",\n\t\t    (long) ps_bytesperrow);\n\t\tfprintf(fd, \"%lu %lu %d\\n\",\n\t\t    (unsigned long) w, (unsigned long) h, bitspersample);\n\t\tfprintf(fd, \"[%lu 0 0 -%lu 0 %lu]\\n\",\n\t\t    (unsigned long) w, (unsigned long) h, (unsigned long) h);\n\t\tfprintf(fd,\n\t\t    \"{currentfile scanLine readhexstring pop} bind\\n\");\n\t\tfprintf(fd, \"%s\\n\", imageOp);\n\t\tPSDataBW(fd, tif, w, h);\n\t\tbreak;\n\t}\n\tputc('\\n', fd);\n}\n"
}