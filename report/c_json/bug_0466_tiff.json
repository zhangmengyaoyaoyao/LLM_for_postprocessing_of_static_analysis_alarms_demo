{
    "Project": "tiff",
    "Tool": "Infer",
    "Bug Type": "BUFFER_OVERRUN_L3",
    "Code_line": "\t\t\t\twritten += t2p_readwrite_pdf_image_tile(t2p, input, output, i2);",
    "Code_function": "tsize_t t2p_write_pdf_trailer(T2P* t2p, TIFF* output)\n{\n\n\ttsize_t written = 0;\n\tchar buffer[32];\n\tint buflen = 0;\n\tsize_t i = 0;\n\n\tfor (i = 0; i < sizeof(t2p->pdf_fileid) - 8; i += 8)\n\t\tsnprintf(t2p->pdf_fileid + i, 9, \"%.8X\", rand());\n\n\twritten += t2pWriteFile(output, (tdata_t) \"trailer\\n<<\\n/Size \", 17);\n\tbuflen = sprintf(buffer, \"%lu\", (unsigned long)(t2p->pdf_xrefcount+1));\n\twritten += t2pWriteFile(output, (tdata_t) buffer, buflen);\n\t_TIFFmemset(buffer, 0x00, 32);\n\twritten += t2pWriteFile(output, (tdata_t) \"\\n/Root \", 7);\n\tbuflen=sprintf(buffer, \"%lu\", (unsigned long)t2p->pdf_catalog);\n\twritten += t2pWriteFile(output, (tdata_t) buffer, buflen);\n\t_TIFFmemset(buffer, 0x00, 32);\n\twritten += t2pWriteFile(output, (tdata_t) \" 0 R \\n/Info \", 12);\n\tbuflen=sprintf(buffer, \"%lu\", (unsigned long)t2p->pdf_info);\n\twritten += t2pWriteFile(output, (tdata_t) buffer, buflen);\n\t_TIFFmemset(buffer, 0x00, 32);\n\twritten += t2pWriteFile(output, (tdata_t) \" 0 R \\n/ID[<\", 11);\n\twritten += t2pWriteFile(output, (tdata_t) t2p->pdf_fileid,\n\t\t\t\tsizeof(t2p->pdf_fileid) - 1);\n\twritten += t2pWriteFile(output, (tdata_t) \"><\", 2);\n\twritten += t2pWriteFile(output, (tdata_t) t2p->pdf_fileid,\n\t\t\t\tsizeof(t2p->pdf_fileid) - 1);\n\twritten += t2pWriteFile(output, (tdata_t) \">]\\n>>\\nstartxref\\n\", 16);\n\tbuflen=sprintf(buffer, \"%lu\", (unsigned long)t2p->pdf_startxref);\n\twritten += t2pWriteFile(output, (tdata_t) buffer, buflen);\n\t_TIFFmemset(buffer, 0x00, 32);\n\twritten += t2pWriteFile(output, (tdata_t) \"\\n%%EOF\\n\", 7);\n\n\treturn(written);\n}"
}