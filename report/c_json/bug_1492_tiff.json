{
    "project": "tiff",
    "tool": "Infer",
    "category": "BUFFER_OVERRUN_L3",
    "file": "libtiff/tif_dirwrite.c",
    "message": "Offset: [1, +oo] Size: [0, +oo] by call to `TIFFWriteRationalArray`.",
    "warning_function_name": "_TIFFWriteDirectory",
    "warning_line": "WriteRationalPair(TIFF_RATIONAL,",
    "warning_context": "\t\t\tcontinue;\n\n\t\t/*\n\t\t * Handle other fields.\n\t\t */\n\t\tswitch (fip->field_bit)\n\t\t{\n\t\tcase FIELD_STRIPOFFSETS:\n\t\t\t/*\n\t\t\t * We use one field bit for both strip and tile\n\n\t\t\t * offsets, and so must be careful in selecting\n\t\t\t * the appropriate field descriptor (so that tags\n\t\t\t * are written in sorted order).\n\t\t\t */\n\t\t\ttag = isTiled(tif) ?\n\t\t\t    TIFFTAG_TILEOFFSETS : TIFFTAG_STRIPOFFSETS;\n\t\t\tif (tag != fip->field_tag)\n\t\t\t\tcontinue;\n\t\t\t\n\t\t\tdir->tdir_tag = (uint16) tag;\n\t\t\tdir->tdir_type = (uint16) TIFF_LONG;\n\t\t\tdir->tdir_count = (uint32) td->td_nstrips;\n\t\t\tif (!TIFFWriteLongArray(tif, dir, td->td_stripoffset))\n\t\t\t\tgoto bad;\n\t\t\tbreak;\n\t\tcase FIELD_STRIPBYTECOUNTS:\n\t\t\t/*\n\t\t\t * We use one field bit for both strip and tile\n\t\t\t * byte counts, and so must be careful in selecting\n\t\t\t * the appropriate field descriptor (so that tags\n\t\t\t * are written in sorted order).\n\t\t\t */\n\t\t\ttag = isTiled(tif) ?\n\t\t\t    TIFFTAG_TILEBYTECOUNTS : TIFFTAG_STRIPBYTECOUNTS;\n\t\t\tif (tag != fip->field_tag)\n\t\t\t\tcontinue;\n\t\t\t\n\t\t\tdir->tdir_tag = (uint16) tag;\n\t\t\tdir->tdir_type = (uint16) TIFF_LONG;\n\t\t\tdir->tdir_count = (uint32) td->td_nstrips;\n\t\t\tif (!TIFFWriteLongArray(tif, dir, td->td_stripbytecount))\n\t\t\t\tgoto bad;\n\t\t\tbreak;\n\t\tcase FIELD_ROWSPERSTRIP:\n\t\t\tTIFFSetupShortLong(tif, TIFFTAG_ROWSPERSTRIP,\n\t\t\t    dir, td->td_rowsperstrip);\n\t\t\tbreak;\n\t\tcase FIELD_COLORMAP:\n\t\t\tif (!TIFFWriteShortTable(tif, TIFFTAG_COLORMAP, dir,\n\t\t\t    3, td->td_colormap))\n\t\t\t\tgoto bad;\n\t\t\tbreak;\n\t\tcase FIELD_IMAGEDIMENSIONS:\n\t\t\tTIFFSetupShortLong(tif, TIFFTAG_IMAGEWIDTH,\n\t\t\t    dir++, td->td_imagewidth);\n\t\t\tTIFFSetupShortLong(tif, TIFFTAG_IMAGELENGTH,\n\t\t\t    dir, td->td_imagelength);\n\t\t\tbreak;\n\t\tcase FIELD_TILEDIMENSIONS:\n\t\t\tTIFFSetupShortLong(tif, TIFFTAG_TILEWIDTH,\n\t\t\t    dir++, td->td_tilewidth);\n\t\t\tTIFFSetupShortLong(tif, TIFFTAG_TILELENGTH,\n\t\t\t    dir, td->td_tilelength);\n\t\t\tbreak;\n\t\tcase FIELD_COMPRESSION:\n\t\t\tTIFFSetupShort(tif, TIFFTAG_COMPRESSION,\n\t\t\t    dir, td->td_compression);\n\t\t\tbreak;\n\t\tcase FIELD_PHOTOMETRIC:\n\t\t\tTIFFSetupShort(tif, TIFFTAG_PHOTOMETRIC,\n\t\t\t    dir, td->td_photometric);\n\t\t\tbreak;\n\t\tcase FIELD_POSITION:\n\t\t\tWriteRationalPair(TIFF_RATIONAL,\n\t\t\t    TIFFTAG_XPOSITION, td->td_xposition,\n\t\t\t    TIFFTAG_YPOSITION, td->td_yposition);\n\t\t\tbreak;\n\t\tcase FIELD_RESOLUTION:\n\t\t\tWriteRationalPair(TIFF_RATIONAL,\n\t\t\t    TIFFTAG_XRESOLUTION, td->td_xresolution,\n\t\t\t    TIFFTAG_YRESOLUTION, td->td_yresolution);\n\t\t\tbreak;\n\t\tcase FIELD_BITSPERSAMPLE:\n\t\tcase FIELD_MINSAMPLEVALUE:\n\t\tcase FIELD_MAXSAMPLEVALUE:\n\t\tcase FIELD_SAMPLEFORMAT:\n\t\t\tif (!TIFFWritePerSampleShorts(tif, fip->field_tag, dir))\n\t\t\t\tgoto bad;\n\t\t\tbreak;\n\t\tcase FIELD_SMINSAMPLEVALUE:\n\t\tcase FIELD_SMAXSAMPLEVALUE:\n\t\t\tif (!TIFFWritePerSampleAnys(tif,\n\t\t\t    _TIFFSampleToTagType(tif), fip->field_tag, dir))\n\t\t\t\tgoto bad;\n\t\t\tbreak;\n\t\tcase FIELD_INKNAMES:\n\t\t\tif (!TIFFWriteInkNames(tif, dir))\n\t\t\t\tgoto bad;\n\t\t\tbreak;\n\t\tcase FIELD_TRANSFERFUNCTION:\n"
}