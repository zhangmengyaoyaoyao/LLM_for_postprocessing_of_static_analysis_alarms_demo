{
    "Project": "Zephyr",
    "Tool": "Infer",
    "category": "Uninitialized Value",
    "file": "subsys/net/lib/lwm2m/lwm2m_obj_firmware.c",
    "message": "The value read from state was never initialized.",
    "warning_function_name": "lwm2m_firmware_set_update_result",
    "warning_line": "LOG_ERR(\"Unexpected result(%u) set while state is %u\",",
    "warning_context": "void lwm2m_firmware_set_update_result(u8_t result)\n{\n\tu8_t state;\n\tbool error = false;\n\n\t/* Check LWM2M SPEC appendix E.6.1 */\n\tswitch (result) {\n\tcase RESULT_DEFAULT:\n\t\tlwm2m_firmware_set_update_state(STATE_IDLE);\n\t\tbreak;\n\tcase RESULT_SUCCESS:\n\t\tif (update_state != STATE_UPDATING) {\n\t\t\terror = true;\n\t\t\tstate = update_state;\n\t\t}\n\n\t\tlwm2m_firmware_set_update_state(STATE_IDLE);\n\t\tbreak;\n\tcase RESULT_NO_STORAGE:\n\tcase RESULT_OUT_OF_MEM:\n\tcase RESULT_CONNECTION_LOST:\n\tcase RESULT_UNSUP_FW:\n\tcase RESULT_INVALID_URI:\n\tcase RESULT_UNSUP_PROTO:\n\t\tif (update_state != STATE_DOWNLOADING) {\n\t\t\terror = true;\n\t\t\tstate = update_state;\n\t\t}\n\n\t\tlwm2m_firmware_set_update_state(STATE_IDLE);\n\t\tbreak;\n\tcase RESULT_INTEGRITY_FAILED:\n\t\tif (update_state != STATE_DOWNLOADING &&\n\t\t    update_state != STATE_UPDATING) {\n\t\t\terror = true;\n\t\t\tstate = update_state;\n\t\t}\n\n\t\tlwm2m_firmware_set_update_state(STATE_IDLE);\n\t\tbreak;\n\tcase RESULT_UPDATE_FAILED:\n\t\tif (update_state != STATE_DOWNLOADING &&\n\t\t    update_state != STATE_UPDATING) {\n\t\t\terror = true;\n\t\t\tstate = update_state;\n\t\t}\n\n\t\tlwm2m_firmware_set_update_state(STATE_IDLE);\n\t\tbreak;\n\tdefault:\n\t\tLOG_ERR(\"Unhandled result: %u\", result);\n\t\treturn;\n\t}\n\n\tif (error) {\n\t\tLOG_ERR(\"Unexpected result(%u) set while state is %u\",\n\t\t\tresult, state);\n\t}\n\n\tupdate_result = result;\n\tNOTIFY_OBSERVER(LWM2M_OBJECT_FIRMWARE_ID, 0, FIRMWARE_UPDATE_RESULT_ID);\n\tLOG_DBG(\"Update result = %d\", update_result);\n}\n"
}