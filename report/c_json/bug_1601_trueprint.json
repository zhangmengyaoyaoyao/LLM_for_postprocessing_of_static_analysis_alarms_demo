{
    "project": "trueprint",
    "tool": "Infer",
    "category": "NULL_DEREFERENCE",
    "file": "src/printers_fl.c",
    "message": "pointer `r->type` last assigned on line 267 could be null and is dereferenced by call to `strlen()` at line 270, column 11.",
    "warning_function_name": "parse_printer_record",
    "warning_line": "r->type[strlen(r->type)-1] = '\\0';",
    "warning_context": "struct printer_record *parse_printer_record(char *line)\n{\n  struct printer_record *r = xmalloc(sizeof(printer_record));\n\n  /* Ignore \"printer\" field */\n  strtok(line, \":\");\n  r->names    = strdup(strtok(NULL, \":\"));\n  r->type     = strdup(strtok(NULL, \":\"));\n\n  /* Overwrite newline at end of last field */\n  r->type[strlen(r->type)-1] = '\\0';\n\n  r->next     = NULL;\n\n  dm('D',3,\"Read printer entry: %s:%s\\n\",\n     r->names,r->type);\n\n  return r;\n}\n"
}